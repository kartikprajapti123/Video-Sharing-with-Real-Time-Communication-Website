<VirtualHost *:80>
    ServerName shareyourclips.online
    ServerAlias www.shareyourclips.online
    ServerAdmin kartikprajapati26122004@gmail.com

    # Redirect HTTP to HTTPS
    Redirect permanent / https://shareyourclips.online:444/

    # Error and access logs
    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>

<VirtualHost *:444>
    ServerName shareyourclips.online:444
    ServerAlias www.shareyourclips.online:444

    SSLEngine on
    SSLCertificateFile /etc/ssl/certs/fullchain.pem
    SSLCertificateKeyFile /etc/ssl/private/privkey.pem

    DocumentRoot /app

    # WSGI Configuration
    WSGIDaemonProcess Jerry-Project python-path=/app python-home=/app/.venv
    WSGIProcessGroup Jerry-Project
    WSGIScriptAlias / /app/Jerry-Project/wsgi.py

    <Directory /app>
        Require all granted
    </Directory>

    # Alias for static and media files
    Alias /static /var/www/Jerry-Project/static
    <Directory /var/www/Jerry-Project/static>
        Require all granted
    </Directory>

    Alias /media /var/www/Jerry-Project/media
    <Directory /var/www/Jerry-Project/media>
        Require all granted
    </Directory>

    # WebSocket proxy settings
    RewriteEngine on
    RewriteCond %{HTTP:UPGRADE} ^WebSocket$ [NC,OR]
    RewriteCond %{HTTP:CONNECTION} ^Upgrade$ [NC]
    RewriteRule .* wss://shareyourclips.online:8001%{REQUEST_URI} [P,QSA,L]

    ProxyPass /wss/ wss://shareyourclips.online:8001/
    ProxyPassReverse /wss/ wss://shareyourclips.online:8001/

</VirtualHost>
