<VirtualHost *:8080>
    ServerName shareyourclips.online
    ServerAlias www.shareyourclips.online
    ServerAdmin kartikprajapati26122004@gmail.com

RewriteEngine On
    RewriteCond %{HTTP_HOST} ^shareyourclips\.online [NC]
    RewriteRule ^(.*)$ https://www.shareyourclips.online:8443$1 [R=301,L]

    RewriteCond %{HTTPS} off
    RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

    
    # Redirect HTTP to HTTPS
    Redirect permanent / https://www.shareyourclips.online:8443/

    # Error and access logs
    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>

<VirtualHost *:8443>
    ServerName shareyourclips.online
    ServerAlias www.shareyourclips.online

    SSLEngine on
    SSLCertificateFile /etc/ssl/certs/fullchain.pem
    SSLCertificateKeyFile /etc/ssl/private/privkey.pem

    # Ensure DocumentRoot points to the correct location
    DocumentRoot /app

    # WSGI Configuration for Django
    WSGIDaemonProcess jerry_project python-path=/app
WSGIProcessGroup jerry_project
WSGIScriptAlias / /app/jerry_project/wsgi.py




    <Directory /app/jerry_project>
        Require all granted
    </Directory>

    # Alias for static files
    Alias /static /app/static
    <Directory /app/static>
        Require all granted
    </Directory>

    # Alias for media files
    Alias /media /app/media
    <Directory /app/media>
        Require all granted
    </Directory>

    # WebSocket proxy settings (if using Django Channels for WebSockets)
    RewriteEngine On
    RewriteCond %{HTTP:UPGRADE} ^WebSocket$ [NC,OR]
    RewriteCond %{HTTP:CONNECTION} ^Upgrade$ [NC]
    RewriteRule .* ws://127.0.0.1:8003%{REQUEST_URI} [P,QSA,L]

    ProxyPass /ws/ ws://127.0.0.1:8003/
    ProxyPassReverse /ws/ ws://127.0.0.1:8003/

    # Proxy WebSocket traffic
    ProxyPass /wss/ ws://127.0.0.1:8003/
    ProxyPassReverse /wss/ ws://127.0.0.1:8003/
    # Error and access logs
    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined

</VirtualHost>
