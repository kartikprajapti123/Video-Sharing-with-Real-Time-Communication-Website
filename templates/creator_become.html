{% extends "base.html" %}
{% block style %}

{% endblock style %}
{% block link %}
<style>
    input[type="radio"]+label {
        font-size: 14px;
        color: #555;
        cursor: pointer;
    }

    input[type="radio"]:checked+label {
        color: #007bff;
    }

    input[type="radio"]:focus {
        outline: none;
        box-shadow: 0 0 2px 2px rgba(0, 123, 255, 0.25);
    }
</style>
{% endblock link %}
{% block body %}

<!-- /Header -->

<!-- New Course -->
<div id="apply" style="display: none;">

    <section class="page-content course-sec" style="margin-top:50px;">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-12">
                    <div class="add-course-header">
                        <h2>Become Creator</h2>
                        <div class="add-course-btns">
                            <ul class="nav">
                                <li>
                                    <a href="/index/" class="btn btn-black">Back to Home</a>
                                </li>
                                
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <div class="card">
                        <!-- Course Wizard -->
                        <div class="widget-set">
                            <div class="widget-setcount" id="creator_become_list">
                                <ul id="progressbar">
                                    <li class="progress-active">
                                        <p><span></span> Terms of Service</p>
                                    </li>
                                    <li>
                                        <p><span></span> Age</p>
                                    </li>
                                    <li>
                                        <p><span></span> Gender</p>
                                    </li>
                                </ul>
                            </div>
                            <div class="widget-content multistep-form">
                                <div id="creator_become_form">
                                    <fieldset id="first">
                                        <div class="add-course-info">
                                            <div class="add-course-inner-header">
                                                <h4>Terms of Service</h4>
                                            </div>
                                            <div class="add-course-form">
                                                <form action="#">
                                                    <div class="input-block">
                                                        <label class="add-course-label">Have you read and agreed to the
                                                            Terms of Service?</label>
                                                        <div>
                                                            <div>
                                                                <input type="radio" id="terms_yes"
                                                                    name="terms_of_service">
                                                                <label class="add-course-label"
                                                                    for="terms_yes">Yes</label>
                                                            </div>
                                                            <div>
                                                                <input type="radio" id="terms_no"
                                                                    name="terms_of_service">
                                                                <label class="add-course-label"
                                                                    for="terms_no">No</label>
                                                            </div>
                                                            <div>
                                                                <a href="/terms_of_service/"
                                                                    style="text-decoration: underline;color:#f66962;">Read
                                                                    Terms of Service</a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </form>
                                            </div>
                                            <div class="widget-btn" style="justify-content: flex-start;">

                                                <a class="btn btn-info-light next_btn">Next</a>
                                            </div>
                                        </div>
                                    </fieldset>
                                    <fieldset class="field-card">
                                        <div class="add-course-info">
                                            <div class="add-course-inner-header">
                                                <h4>Age</h4>
                                            </div>
                                            <div class="add-course-form">
                                                <form action="#">
                                                    <div class="input-block">
                                                        <label class="add-course-label">What is your age?</label>
                                                        <div>
                                                            <div>
                                                                <input type="radio" id="age_above" name="age">
                                                                <label class="add-course-label" for="age_above">Above 21
                                                                    years</label>
                                                            </div>
                                                            <div>
                                                                <input type="radio" id="age_below" name="age">
                                                                <label class="add-course-label" for="age_below">Below 21
                                                                    years</label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </form>
                                            </div>
                                            <div class="widget-btn" style="justify-content: flex-start;">
                                                <a class="btn btn-black prev_btn" style="margin:0px 10px">Previous</a>
                                                <a class="btn btn-info-light next_btn">Next</a>
                                            </div>
                                        </div>
                                    </fieldset>
                                    <fieldset class="field-card">
                                        <div class="add-course-info">
                                            <div class="add-course-inner-header">
                                                <h4>Gender</h4>
                                            </div>
                                            <div class="add-course-form">
                                                <form action="#">
                                                    <div class="input-block">
                                                        <label class="add-course-label">What is your gender?</label>
                                                        <div>
                                                            <div>
                                                                <input type="radio" id="gender_Male" name="gender">
                                                                <label class="add-course-label"
                                                                    for="gender_Male">Male</label>
                                                            </div>
                                                            <div>
                                                                <input type="radio" id="gender_Female" name="gender">
                                                                <label class="add-course-label"
                                                                    for="gender_Female">Female</label>
                                                            </div>
                                                            <div>
                                                                <input type="radio" id="gender_Other" name="gender">
                                                                <label class="add-course-label"
                                                                    for="gender_Other">Other</label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </form>
                                            </div>
                                            <div class="widget-btn" style="justify-content: flex-start;">
                                                <a class="btn btn-black prev_btn" style="margin:0px 10px" >Previous</a>
                                                <ul class="nav">
                                                    <li>
                                                        <a href="javascript:void(0);" class="btn btn-success-dark"
                                                            id="creater_become_save">Save</a>
                                                    </li>
                                                </ul>

                                            </div>
                                        </div>
                                    </fieldset>
                                </div>
                                <div id="creator_become_success" style="display: none; margin-top: 40px;">
                                    <fieldset class="field-card" style="display: block;">
                                        <div class="add-course-info">
                                            <div class="add-course-msg">
                                                <i class="fas fa-circle-check"></i>
                                                <h4>Your information has been successfully submitted.</h4>
                                                <p>Our team will review your submission to verify your eligibility. This
                                                    process typically takes around one day. You will be notified once
                                                    the review is complete.</p>
                                            </div>
                                        </div>
                                    </fieldset>
                                </div>
                            </div>
                        </div>
                        <!-- /Course Wizard -->
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

<div id="pending" style="display: none;">

    <section class="page-content course-sec" style="margin-top:50px;">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-12">
                    <div class="add-course-header">
                        <h2>Creator's Status is Pending</h2>
                        <div class="add-course-btns">
                            <ul class="nav">
                                <li>
                                    <a href="/index/" class="btn btn-black">Back to Home</a>
                                </li>

                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <div class="card">
                        <!-- Course Wizard -->
                        <div class="widget-set">
                            <div class="widget-setcount">
                            </div>
                            <div class="widget-content multistep-form">

                                <div style="display: block; margin-top: 40px;">
                                    <fieldset class="field-card" style="display: block;">
                                        <div class="add-course-info">
                                            <div class="add-course-msg">
                                                <i class="fas fa-circle-check"></i>
                                                <h4>You have already submitted your information.</h4>
                                                <p>Our team will review your submission to verify your eligibility. This
                                                    process typically takes around one day. You will be notified once
                                                    the review is complete.</p>
                                            </div>
                                        </div>
                                    </fieldset>
                                </div>
                            </div>
                        </div>
                        <!-- /Course Wizard -->
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

<div id="cancelled" style="display: none;">

    <section class="page-content course-sec" style="margin-top:50px;">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-12">
                    <div class="add-course-header">
                        <h2>Creator's Status is Cancelled</h2>
                        <div class="add-course-btns">
                            <ul class="nav">
                                <li>
                                    <a href="/index/" class="btn btn-black">Back to Home</a>
                                </li>

                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <div class="card">
                        <!-- Course Wizard -->
                        <div class="widget-set">
                            <div class="widget-setcount">
                            </div>
                            <div class="widget-content multistep-form">

                                <div style="display: block; margin-top: 40px;">
                                    <fieldset class="field-card" style="display: block;">
                                        <div class="add-course-info">
                                            <div class="add-course-msg">
                                                <i class="fas fa-circle-xmark"></i></i>
                                                <h4>Your information has been rejected.</h4>
                                                <p>You can try again </p>
                                                <div class="add-course-btns" style="    display: grid;
    place-items: center;
    margin-top: 11px;
">
                                                    <ul class="nav">
                                                        <li>
                                                            <a href="#" class="btn btn-black" id="apply_again">Apply
                                                                again</a>
                                                        </li>

                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </fieldset>
                                </div>
                            </div>
                        </div>
                        <!-- /Course Wizard -->
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

<div id="approved" style="display: none;">

    <!-- Main Wrapper -->
    <div class="main-wrapper" style="margin-top: 100px;">

        <!-- Header -->
        <!-- /Header -->

        <!-- Breadcrumb -->
        <div class="breadcrumb-bar breadcrumb-bar-info">
            <div class="container">
                <div class="row">
                    <div class="col-md-12 col-12">
                        <div class="breadcrumb-list">
                            <h2 class="breadcrumb-title">Dashboard</h2>
                            <nav aria-label="breadcrumb" class="page-breadcrumb">
                                <ol class="breadcrumb">
                                    <li class="breadcrumb-item"><a href="/index/">Home</a></li>
                                    <li class="breadcrumb-item active" aria-current="page">Dashboard</li>
                                </ol>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Breadcrumb -->

        <!-- Page Content -->
        <div class="page-content">
            <div class="container">
                <div class="row">

                    <!-- sidebar -->
                    <div class="col-xl-3 col-lg-3 theiaStickySidebar">
                        <div class="settings-widget dash-profile">
                            <div class="settings-menu">
                                <div class="profile-bg">
                                    <div class="profile-img">
                                        <a href="/myprofile/"><img id="profile_page_image"
                                                src="/media/profile_pictures/default_profile_image.png" alt="Img"></a>
                                    </div>
                                </div>
                                <div class="profile-group">
                                    <div class="profile-name text-center">
                                        <h4 id="profile_page_username2"> Username</h4>
                                        <a href="#" class="add-course btn-primary" id="share-button">
                                            <i class="fas fa-share-alt"></i> Share Profile URL
                                        </a>
                                        <a href="/upload-video/" class="add-course btn-primary">
                                            <i class="fas fa-upload"></i> Upload New Video
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="settings-widget account-settings">
                            <div class="settings-menu">
                                <h3>Creators' Corner</h3>
                                <ul>
                                    <li class="nav-item active">
                                        <a href="/creator/" class="nav-link" id="creator_check">
                                        </a>
                                    </li>
                                    <li class="nav-item ">
                                        <a href="/myprofile/" class="nav-link">
                                            <i class="bx bxs-user"></i>My Profile
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="/mypost/" class="nav-link">
                                            <i class="bx bxs-tachometer"></i>My Videos
                                        </a>
                                    </li>
                                    <!-- <li class="nav-item">
                                        <a href="instructor-enrolled-course.html" class="nav-link">
                                            <i class="bx bxs-graduation"></i>Enrolled Courses
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="instructor-wishlist.html" class="nav-link">
                                            <i class="bx bxs-heart"></i>Wishlist
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="instructor-reviews.html" class="nav-link">
                                            <i class="bx bxs-star"></i>Reviews
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="instructor-quiz.html" class="nav-link">
                                            <i class="bx bxs-shapes"></i>My Quiz Attempts
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="instructor-orders.html" class="nav-link">
                                            <i class="bx bxs-cart"></i>Order History
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="instructor-qa.html" class="nav-link">
                                            <i class="bx bxs-bookmark-alt"></i>Question & Answer
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="instructor-referral.html" class="nav-link">
                                            <i class="bx bxs-user-plus"></i>Referrals
                                        </a>
                                    </li> -->
                                    <li class="nav-item">
                                        <a href="/contact-list/" class="nav-link">
                                            <i class="bx bxs-chat"></i>Messages
                                        </a>
                                    </li>
                                    
                                    <!-- <li class="nav-item">
                                        <a href="instructor-notifications.html" class="nav-link">
                                            <i class="bx bxs-bell"></i>Notifications
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="instructor-tickets.html" class="nav-link">
                                            <i class="bx bxs-coupon"></i>Support Tickets
                                        </a>
                                    </li> -->
                                </ul>
                                <!-- <h3>Instructor</h3>
                                <ul>
                                    <li class="nav-item">
                                        <a href="instructor-course.html" class="nav-link ">
                                            <i class="bx bxs-rocket"></i>My Courses
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="instructor-announcements.html" class="nav-link">
                                            <i class="bx bxs-volume-full"></i>Announcements
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="instructor-withdraw.html" class="nav-link ">
                                            <i class="bx bxs-wallet"></i>Withdrawls
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="instructor-quiz-attempts.html" class="nav-link">
                                            <i class="bx bxs-shapes"></i>Quiz Attempts
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="instructor-assignment.html" class="nav-link ">
                                            <i class="bx bxs-file"></i>Assignments
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="instructor-earnings.html" class="nav-link">
                                            <i class="bx bxs-badge-dollar"></i>Earnings
                                        </a>
                                    </li>
                                </ul> -->
                                <h3>Account Settings</h3>
                                <ul>
                                    <li class="nav-item">
                                        <a href="/mychangepassword/" class="nav-link ">
                                            <i class="bx bxs-cog"></i>Change Password
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <div class="nav-link" onClick="LogoutApi()"><a href="#">

                                                <i class="bx bxs-log-out"></i>Logout
                                            </a>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <!-- /Sidebar -->

                    <!-- Student Dashboard -->
                    <div class="col-xl-9 col-lg-9">

                        <!-- Dashboard Grid -->
                        <div class="row justify-content-center">
                            
                            
                            
                            <div class="col-lg-4 col-md-6 d-flex">
                                <div class="card dash-info flex-fill">
                                    <div class="card-body">
                                        <h5>Approved Videos</h5>
                                        <h2 id="approved_videos"></h2>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4 col-md-6 d-flex">
                                <div class="card dash-info flex-fill">
                                    <div class="card-body">
                                        <h5>Pending Videos</h5>
                                        <h2 id="pending_videos"></h2>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4 col-md-6 d-flex">
                                <div class="card dash-info flex-fill">
                                    <div class="card-body">
                                        <h5>Approval Denied</h5>
                                        <h2 id="canceled_videos"></h2>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4 col-md-6 d-flex">
                                <div class="card dash-info flex-fill">
                                    <div class="card-body">
                                        <h5>Total Videos</h5>
                                        <h2 id="total_videos"></h2>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4 col-md-6 d-flex">
                                <div class="card dash-info flex-fill">
                                    <div class="card-body">
                                        <h5>Videos Bought</h5>
                                        <h2 id="purchased_videos">00</h2>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4 col-md-6 d-flex">
                                <div class="card dash-info flex-fill">
                                    <div class="card-body">
                                        <h5>Total Earnings</h5>
                                        <h2 id="total_earnings">$00.00</h2>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- /Dashboard Grid -->

                        <div class="instructor-course-table">
                            <div class="dashboard-title">
                                <h4 id="tabel_list">All Videos Overview</h4>
                            </div>
                            <div class="table-responsive custom-table">

                                <!-- Referred Users-->
                                <table class="table table-nowrap mb-0">
                                    <thead>
                                        <tr>
                                            <th>Videos</th>
                                            <th>Purchase</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody id="list_videos">
                                    </tbody>
                                </table>

                            </div>
                        </div>
                        <div class="dash-pagination">
                            <div class="row align-items-center">
                                <div class="col-6"
                                    style="z-index: 1000 !important;display:flex;justify-content:center;">
                                    <p class="pagination_list" style="color: #ff4667;"></p>
                                </div>
                                <div class="col-6"
                                    style="z-index: 1000 !important;display:flex;justify-content:center;">
                                    <ul class="pagination">

                                    </ul>
                                </div>
                            </div>
                        </div>


                        <div class="dashboard-title">
                            <h4>Uploaded Videos Status</h4>
                        </div>
                        <div class="row">

                            <!-- Course Grid -->

                            <div class="settings-widget card-info">
                                <div class="settings-menu p-0">
                                    <div class="profile-heading">
                                        <h3>Video Status</h3>
                                        <p>Manage the status of your videos and updates here.</p>
                                    </div>
                                    <div class="checkout-form pb-0">
                                        <div class="wishlist-tab">
                                            <ul class="nav">
                                                <li class="nav-item">
                                                    <a href="javascript:void(0);" class="active" data-bs-toggle="tab"
                                                        data-bs-target="#enroll-courses">Approved (<span
                                                            id="approved_count"></span>)</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a href="javascript:void(0);" data-bs-toggle="tab"
                                                        data-bs-target="#active-courses">Pending (<span
                                                            id="pending_count"></span>)</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a href="javascript:void(0);" data-bs-toggle="tab"
                                                        data-bs-target="#complete-courses">Approval Denied (<span
                                                            id="canceled_count"></span>)</a>
                                                </li>
                                            </ul>
                                        </div>

                                        <div class="tab-content">
                                            <div class="tab-pane fade show active" id="enroll-courses">
                                                <div class="row" id="video-approved">

                                                    <!-- Course Grid -->

                                                    <!-- /Course Grid -->

                                                    <!-- Course Grid -->

                                                    <!-- /Course Grid -->

                                                </div>
                                            </div>

                                            <div class="tab-pane fade" id="active-courses">
                                                <div class="row" id="video-pending">

                                                    <!-- Course Grid -->
                                                    <!-- /Course Grid -->

                                                </div>
                                            </div>

                                            <div class="tab-pane fade" id="complete-courses">
                                                <div class="row" id="video-canceled">

                                                    <!-- Course Grid -->
                                                    <!-- /Course Grid -->

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- <div class="dash-pagination">
                                    <div class="row align-items-center">
                                        <div class="col-6">
                                            <p class="pagination_list">Page 1 of 2</p>
                                        </div>
                                        <div class="col-6">
                                            <ul class="pagination">
                                                <li class="active">
                                                    <a href="#">1</a>
                                                </li>
                                                <li>
                                                    <a href="#">2</a>
                                                </li>
                                                <li>
                                                    <a href="#"><i class="bx bx-chevron-right"></i></a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div> -->

                            <!-- /Instructor Courses -->

                        </div>
                        <!-- /Course Grid -->

                    </div>
                </div>

                <!-- Student Dashboard -->

            </div>
        </div>
    </div>
    <!-- /Page Content -->

    <!-- Footer -->
</div>


<!-- /New Course -->

{% endblock body %}
<!-- Footer -->
{% block script %}
<script>
    const creater_become_save = document.getElementById("creater_become_save")
    const creator_become_form = document.getElementById("creator_become_form")
    const creator_become_list = document.getElementById("creator_become_list")

    const pending = document.getElementById("pending")
    const cancelled = document.getElementById("cancelled")
    const approved = document.getElementById("approved")
    const apply = document.getElementById("apply")

    const apply_again = document.getElementById("apply_again")

    const creator_become_success = document.getElementById("creator_become_success")
    let user_id = 0;
    let username = "";
    userApi = async () => {
        await fetch(`${window.location.origin}/api/user/`, {
            "method": "get",
            "headers": {
                "content-type": "application/json",
                "Authorization": `Bearer ${authenticated}`
            }
        }).then((response) => {
            return response.json()
        }).then((response) => {
            if (response.success) {
                user_id = response.data.id
                username = response.data.username
                data = {
                    "user": user_id
                }
                fetch(`${window.location.origin}/api/creator-approval/create_approval_status/`, {
                    method: "POST",
                    headers: {
                        "content-type": "application/json",
                        "Authorization": `Bearer ${authenticated}`
                    },
                    body: JSON.stringify(data)
                }).then((response) => {
                    return response.json()
                }).then((response) => {
                    console.log("amin", response)
                    if (response.status == 'pending') {
                        pending.style.display = "block"
                    }
                    else if (response.status == "None") {
                        apply.style.display = "block"
                    }
                    else if (response.status == "canceled") {
                        console.log("cancelled")
                        cancelled.style.display = "block"
                    }
                    else if (response.status == "approved") {
                        approved.style.display = "block"
                        getUserPosts(1);
                        getUserPosts2(1);

                        all_dashbored_data();

                        //followers_following();



                    }

                })


            }
            console.log(response)
        })
    }
    userApi()


    creater_become_save.onclick = become_creator
    async function become_creator(e) {
        card.style.display = "none";
        e.preventDefault();

        // Get the values from the form
        const terms_of_service = document.querySelector('input[name="terms_of_service"]:checked');
        const age = document.querySelector('input[name="age"]:checked');
        const gender = document.querySelector('input[name="gender"]:checked');

        // Prepare the data object
        const data = {
            terms_of_service: terms_of_service ? terms_of_service.id === 'terms_yes' : null,
            age: age ? age.id === 'age_above' : "",  // true for 'above 21', false for 'below 21'
            gender: gender ? gender.id.replace('gender_', '') : null,
            user: user_id,
            // 'male', 'female', or 'other'
        };

        console.log(data)
        // Send the data to the server
        await fetch(`${window.location.origin}/api/creator-approval/`, {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "Authorization": `Bearer ${authenticated}`
            },
            body: JSON.stringify(data)
        }).then((response) => {
            return response.json();
        }).then((response) => {
            if (response.success) {
                card.style.display = "none";

                creator_become_form.style.display = "none";
                creator_become_success.style.display = "block";
                creator_become_list.style.display = "none"
                creater_become_save.style.display = "none"
            }
            if (response.success == false) {
                if (response.message['gender']) {

                    message_content.innerHTML = response.message["gender"][0];
                }
                else if (response.message['age']) {
                    message_content.innerHTML = response.message["age"][0];

                }
                else if (response.message['terms_of_service']) {
                    message_content.innerHTML = response.message["terms_of_service"][0];

                }
                else if (response.message['non_field_errors']) {
                    message_content.innerHTML = response.message["non_field_errors"][0];

                }
                card.style.display = "block";
                card.style.borderLeft = "10px solid red";
                message_type.innerHTML = "Error";
                message_type.style.color = "red";
                message_icon_parent.style.color = "red";
                message_icon_child.classList = "fas fa-times-circle";
            }
        })
    }

    apply_again.onclick = apply_agagin
    async function apply_agagin(e) {
        e.preventDefault();
        data = {
            user_id: user_id
        }
        // Get the values from the form
        await fetch(`${window.location.origin}/api/creator-approval/delete-creator/`, {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "Authorization": `Bearer ${authenticated}`
            },
            body: JSON.stringify(data)
        }).then((response) => {
            return response.json();
        }).then((response) => {
            if (response.success) {
                apply.style.display = "block"
                cancelled.style.display = "none"
            }
        })
    }


    const getUserPosts = async (page) => {
        console.log(page)
        await fetch(`${window.location.origin}/api/upload-post/?page=${page}&user_username=${username}`, {
            method: "GET",
            headers: {
                "content-type": "application/json",
            }
        }).then(response => response.json())
            .then(response => {
                if (response.results) {
                    console.log("User posts fetched successfully:", response);

                    // Update total pages and current page
                    totalPages = Math.ceil(response.count / 10);
                    console.log(totalPages) // Assuming 10 posts per page
                    currentPage = page;

                    // Display posts
                    displayPosts(response.results);


                    // Update pagination UI
                    updatePagination();
                } else {
                    console.log("Failed to fetch user posts.");
                }
            }).catch(error => {
                console.error("Error fetching user posts:", error);
            });
    };

    const displayPosts = (data) => {
        let str = "";

        if (data.data.length === 0) {
            str = `
                 <tr>
        <td colspan="3" style="text-align: center; padding: 53px 10px;">
            <div style="display: flex; justify-content: center; align-items: center; flex-direction: column;">
                <i class="fas fa-exclamation-circle" style="color: #ff4667; font-size: 50px;"></i>
                <h4 style="text-align: center; margin: 10px; color: gray;">
                    There are no Videos Uploaded.
                </h4>
                                   <ul class="nav">
                            <li>
                                <a href="/upload-video/" class="btn btn-black" style="background: #ff4667;
    border: 1px solid #ffffff;
    color: #fff;">Upload Video</a>
                            </li>
                            
                        </ul>
            </div>
        </td>
    </tr>`;
        } else {
            data.data.forEach(post => {


                const truncatedTitle = post.title.length > 60 ? `${post.title.substring(0, 60)}...` : post.title;

                str += `
                    <tr>
                                            <td>
                                                <div class="table-course-detail">
                                                    <a href="/post-view/${post.id}/" class="course-table-img">
                                                        <span><img src="${post.thumbnail}"
                                                                alt="Img" style="object-position:center;object-fit:contain;"></span>
                                                        ${post.title}
                                                    </a>
                                                </div>
                                            </td>
                                            <td>0</td>
                                            <td>${post.status}</td>
                                        </tr>
                    `;
            });
        }

        document.getElementById('list_videos').innerHTML = str;




    };

    const updatePagination = () => {
        const paginationList = document.getElementsByClassName("pagination_list")[0];
        if (totalPages > 1) {

            paginationList.innerHTML = `Page ${currentPage} of ${totalPages}`;
        }

        const pagination = document.querySelector('.pagination');
        pagination.innerHTML = '';

        // Add "Previous" button only if we're not on the first page
        if (currentPage > 1) {
            pagination.innerHTML += `<li><a onclick="getUserPosts(${currentPage - 1}); document.getElementById('tabel_list').scrollIntoView({ behavior: 'smooth' });" style="box-shadow: 0px 0px 10px 0px gray;"><i class="bx bx-chevron-left" style="font-size:25px;"></i></a></li>`;
        }

        // Add "Next" button only if we're not on the last page
        if (currentPage < totalPages) {
            pagination.innerHTML += `<li><a onclick="getUserPosts(${currentPage + 1}); document.getElementById('tabel_list').scrollIntoView({ behavior: 'smooth' });" style="box-shadow: 0px 0px 10px 0px gray;" ><i class="bx bx-chevron-right" style="font-size:25px;"></i></a></li>`;
        }
    };

    const getUserPosts2 = async () => {
        await fetch(`${window.location.origin}/api/upload-post/?user_username=${username}&no_pagination=true`, {
            method: "GET",
            headers: {
                "content-type": "application/json",
                "Authorization": `Bearer ${authenticated}`
            }
        }).then(response => response.json())
            .then(response => {
                console.log(response);
                if (response.data) {
                    console.log("User posts fetched successfully:", response);
                    // Display posts
                    displayPosts2(response.data);
                } else {
                    console.log("Failed to fetch user posts.");
                }
            }).catch(error => {
                console.error("Error fetching user posts:", error);
            });
    };
    const displayPosts2 = (data) => {
        console.log(data);
        //document.getElementsByClassName("pagination_list")[0].innerHTML = `Page ${currentPage} of ${Math.ceil(totalCount / 10)}`

        let pending = "";
        let approved = "";
        let canceled = "";
        let pendingcount = 0;
        let approvedcount = 0;
        let canceledcount = 0;

        data.forEach(data => {
            const timestamp = new Date(data.created_at);

            // Format the date and time
            const formattedDate = timestamp.toLocaleDateString('en-US', {
                month: '2-digit',
                day: '2-digit',
                year: 'numeric'
            });
            const formattedTime = timestamp.toLocaleTimeString('en-US', {
                hour: '2-digit',
                minute: '2-digit',
                hour12: true
            });

            // Truncate the title if it's longer than 60 characters
            const truncatedTitle = data.title.length > 60 ? `${data.title.substring(0, 60)}...` : data.title;

            // Determine the video source and hover behavior
            const videoSrc = data.preview || data.video; // Use preview if available, otherwise use video
            const hoverAttributes = videoSrc
                ? 'onmouseover="this.play()" onmouseout="this.pause()"'
                : '';

            // Ensure video source URL is valid
            const videoElement = videoSrc
                ? `<video style="width: 100%;
        height: 151px;
        object-fit: contain;
        object-position: center;" alt="Img" src="${videoSrc}" poster="${data.thumbnail}" ${hoverAttributes} muted></video>`
                : '<div class="video-error">No video available</div>'; // Show an error message if no video

            const postHTML = (status) => `
                    <div class="col-lg-12 col-md-12 d-flex">
									<div class="course-box course-design list-course d-flex">
										<div class="product">
											<div class="product-img">
												<a href="/post-view/${data.id}/">
													${videoElement}
												</a>
												<div class="price" style="box-shadow: 0px 0px 10px 0px grey;">
													<h3>$${data.price} </h3>
												</div>
											</div>
											<div class="product-content">
												<div class="head-course-title">
													<h3 class="title"><a href="/post-view/${data.id}/">${data.title}</a></h3>
													<!-- <div class="all-btn all-category d-flex align-items-center">
														<a href="#" class="btn btn-primary">BUY NOW</a>
													</div> -->
												</div>
												<div class="course-info border-bottom-0 pb-0 d-flex align-items-center">
													
													
													
												</div>
												<div class="course-edit-btn d-flex align-items-center justify-content-between" style="color:grey;">
									<a href="/update-video/${data.id}" style="color:grey;"><i class="bx bx-edit me-2" style="color:grey;"></i>Edit</a>
									<a href="#" onclick="PostDelete(${data.id})" style="color:grey;"><i class="bx bx-trash me-2" style="color:grey;"></i>Delete</a>
								</div>
												</div>
												
																		
													
												<div class="course-group d-flex mb-0">
													<div class="course-group-img d-flex">
														
														
													</div>
													
												</div>
											</div>
										</div>
									</div>
								</div>`;

            if (data.status === "approved") {
                approved += postHTML("approved");
                approvedcount++;
            }
            if (data.status === "pending") {
                pending += postHTML("pending");
                pendingcount++;
            }
            if (data.status === "canceled") {
                canceled += postHTML("canceled");
                canceledcount++;
            }
        });

        // Update the DOM with the generated HTML and counts
        document.getElementById('video-approved').innerHTML = approved || `
                <div style="width: 100%; padding: 53px 10px; height: 100%; display: flex; justify-content: center; align-items: center; flex-direction: column">
                    <i class="fas fa-exclamation-circle" style="color: #ff4667; font-size: 50px;"></i>
                    <h4 style="text-align: center; width: 70%; margin: 10px; color: gray;">
                        There are no approved Video.
                    </h4>
                </div>`;
        document.getElementById('video-pending').innerHTML = pending || `
                <div style="width: 100%; padding: 53px 10px; height: 100%; display: flex; justify-content: center; align-items: center; flex-direction: column">
                    <i class="fas fa-exclamation-circle" style="color: #ff4667; font-size: 50px;"></i>
                    <h4 style="text-align: center; width: 70%; margin: 10px; color: gray;">
                        There are no pending Video.
                    </h4>
                </div>`;
        document.getElementById('video-canceled').innerHTML = canceled || `
                <div style="width: 100%; padding: 53px 10px;height: 100%; display: flex; justify-content: center; align-items: center; flex-direction: column">
                    <i class="fas fa-exclamation-circle" style="color: #ff4667; font-size: 50px;"></i>
                    <h4 style="text-align: center; width: 70%; margin: 10px; color: gray;">
                        There are no Approval Denied Video.
                    </h4>
                </div>`;

        document.getElementById('approved_count').innerHTML = approvedcount;
        document.getElementById('pending_count').innerHTML = pendingcount;
        document.getElementById('canceled_count').innerHTML = canceledcount;

        // Pagination controls
        //const pagination = document.querySelector('.dash-pagination .pagination');
        //pagination.innerHTML = '';

        //const createPageLink = (page, text, isActive = false) => `
        //	<li ${isActive ? 'class="active"' : ''}>
        //		<a href="#" onclick="fetchPage(${page})" style="height: 40px;
        //width: 40px;
        //box-shadow: 0px 0px 5px gray;" >${text}</a>
        //	</li>
        //`;
        //
        //// Calculate total pages
        //const totalPages = Math.ceil(totalCount / perPage);
        //
        //if (previousPage) {
        //	pagination.innerHTML += createPageLink(currentPage - 1, '<i class="bx bx-chevron-left" style="font-size: 20px;color:black;"></i>');
        //}
        //for (let i = 1; i <= totalPages; i++) {
        //	pagination.innerHTML += createPageLink(i, i, i === currentPage);
        //}
        //if (nextPage) {
        //	pagination.innerHTML += createPageLink(currentPage + 1, '<i class="bx bx-chevron-right" style="font-size: 20px;color:black;"></i>');
        //}
    };

    async function all_dashbored_data() {
        await fetch(`${window.location.origin}/api/upload-post/?user_username=${username}&no_pagination=true`)
            .then((response) => {
                return response.json();
            })
            .then((response) => {
                console.log(response);
                if (response.success) {
                    let count = 0;
                    let pending = 0;
                    let approved = 0;
                    let canceled = 0;

                    response.data.forEach((data) => {
                        if (data.status == "pending") {
                            pending++;
                        } else if (data.status == "approved") {
                            approved++;
                        } else if (data.status == "canceled") {
                            canceled++;
                        }
                        count++;
                    });

                    // Ensure the numbers have at least two digits
                    document.getElementById("total_videos").innerHTML = String(count).padStart(2, '0');
                    document.getElementById("pending_videos").innerHTML = String(pending).padStart(2, '0');
                    document.getElementById("approved_videos").innerHTML = String(approved).padStart(2, '0');
                    document.getElementById("canceled_videos").innerHTML = String(canceled).padStart(2, '0');
                }
            });
    }


    async function PostDelete(id) {
        console.log("called")
        let check = confirm("Are you sure you want to delete Video ! After delete You wil not be Restore It ")
        if (check) {

            card.style.display = "none";
            await fetch(`${window.location.origin}/api/upload-post/${id}/`, {
                method: "DELETE",
                headers: {
                    "content-type": "application/json",
                    "Authorization": `Bearer ${authenticated}`
                }

            }).then((response) => {
                return response.json()
            }).then((response) => {
                if (response.success) {
                    card.style.display = "flex";
                    card.style.borderLeft = "10px solid green";

                    message_content.innerHTML = response.message;
                    message_type.innerHTML = "Success";
                    message_type.style.color = "green";
                    message_icon_parent.style.color = "green";
                    message_icon_child.classList = "fas fa-check-circle";

                    setTimeout(() => {
                        card.style.display = "none"
                    }, 3000)
                    userApi();
                }
                else {
                    message_content.innerHTML = response.message;
                    card.style.display = "flex";
                    card.style.borderLeft = "10px solid red";
                    message_type.innerHTML = "Error";
                    message_type.style.color = "red";
                    message_icon_parent.style.color = "red";
                    message_icon_child.classList = "fas fa-times-circle";
                }
            })
        }
        else {
            return
        }

    }

    // Initialize with the first page


    //async function followers_following(id) {
    //    fetch(`${window.location.origin}/api/follow/get-followers-following/?user_id=${user_id}`, {
    //        method: "get",
    //        headers: {
    //            "content-type": "application/json",
    //            "Authorization": `Bearer ${authenticated}`
    //        },
//
    //    }).then((response) => {
    //        return response.json()
    //    }).then((response) => {
    //        console.log(response)
    //        if (response.success) {
    //            document.getElementById("followers").innerHTML = String(response.data.followers).padStart(2, '0');
    //            document.getElementById("following").innerHTML = String(response.data.following).padStart(2, '0');
    //        }
    //        else {
    //            message_content.innerHTML = response.message;
    //            card.style.display = "flex";
    //            card.style.borderLeft = "10px solid red";
    //            message_type.innerHTML = "Error";
    //            message_type.style.color = "red";
    //            message_icon_parent.style.color = "red";
    //            message_icon_child.classList = "fas fa-times-circle";
    //        }
    //    })
    //}


</script>
{% endblock script %}