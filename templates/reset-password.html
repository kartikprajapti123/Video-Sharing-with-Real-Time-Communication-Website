<!DOCTYPE html> 
<html lang="en">
	<head>

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
		<title>Reset-Password</title>
		
		<!-- Favicon -->
		<link rel="shortcut icon" type="image/x-icon" href="/static/img/favicon.svg">
		
		<!-- Bootstrap CSS -->
		<link rel="stylesheet" href="/static/css/bootstrap.min.css">
		
		<!-- Fontawesome CSS -->
		<link rel="stylesheet" href="/static/plugins/fontawesome/css/fontawesome.min.css">
		<link rel="stylesheet" href="/static/plugins/fontawesome/css/all.min.css">

		<!-- Owl Carousel CSS -->
		<link rel="stylesheet" href="/static/css/owl.carousel.min.css">
		<link rel="stylesheet" href="/static/css/owl.theme.default.min.css">
		
		<!-- Feathericon CSS -->
        <link rel="stylesheet" href="/static/plugins/feather/feather.css">

		<!-- Main CSS -->
		<link rel="stylesheet" href="/static/css/style.css">
		<link rel="stylesheet" href="/static/css/message_box.css">

	
	</head>
	<body>

		<!-- Main Wrapper -->
		<div class="main-wrapper">
		
			<div class="row">
			
				<!-- Login Banner -->
				<div class="col-md-6 login-bg">
					<div class="owl-carousel login-slide owl-theme">
						<!-- Slide 1 -->
						<div class="welcome-login">
							<div class="login-banner">
								<img src="/static/img/professional-video1.png" class="img-fluid" alt="Welcome to ShareYourClips.online">
							</div>
							<div class="mentor-course text-center">
								<h2>Welcome to <br>ShareYourClips.online</h2>
								<p>Join a community where professionals showcase their expertise and earn while inspiring others. Share, learn, and grow with us!</p>
							</div>
						</div>
						<!-- Slide 2 -->
						<div class="welcome-login">
							<div class="login-banner">
								<img src="/static/img/professional-video2.png" class="img-fluid" alt="Professional Learning Platform">
							</div>
							<div class="mentor-course text-center">
								<h2>Empower Your Knowledge</h2>
								<p>Explore high-quality content from experts in various fields, including teaching, motivation, fitness, and more. Build your career through learning.</p>
							</div>
						</div>
						<!-- Slide 3 -->
						<div class="welcome-login">
							<div class="login-banner">
								<img src="/static/img/professional-video3.png" class="img-fluid" alt="Inspire and Be Inspired">
							</div>
							<div class="mentor-course text-center">
								<h2>Inspire and Be Inspired</h2>
								<p>Whether you're an expert sharing your journey or a learner seeking inspiration, ShareYourClips.online is your go-to platform for professional growth.</p>
							</div>
						</div>
					</div>
				</div>
				
				<!-- /Login Banner -->
				
				<div class="col-md-6 login-wrap-bg">		
				
					<!-- Login -->
					<div class="login-wrapper">
						<div class="loginbox">
							<div class="img-logo">
								<img src="/static/img/logo.svg" class="img-fluid" alt="Logo">
								<div class="back-home">
									<a href="index.html">Back to Home</a>
								</div>
							</div>
							<h1>Reset Password</h1>
							<!-- Success messagae start  -->
							<div class="wrapper-success" id="message-box">
								<div id="card">
									<div class="icon" id="message-icon-parent"><i class="fas fa-times-circle "
											id="message-icon-child"></i></div>
									<div class="subject">
										<h3 id="message-type">Success</h3>
										<p id="message-content">Anyone with access can view your invited visitors</p>
									</div>
									<div class="icon-times" id="message_close"><i class="fas fa-times"></i></div>
								</div>
							</div>

							<!-- Success messagae end  -->
							
							<form id="reset_password_form">
								<div class="input-block">
									<label class="form-control-label">Password</label>
									<input type="password" id="password" class="form-control" placeholder="Enter password" required="true">
								</div>
                                <div class="input-block">
									<label class="form-control-label">Re-Password</label>
									<input type="password" id="password2" class="form-control" placeholder="Enter password again" required="true">
								</div>
								<div class="d-grid">
									<button class="btn btn-start" type="submit" role="submit">Submit</button>
								</div>
							</form>
						</div>
					</div>
					<!-- /Login -->
					
				</div>
				
			</div>
		   
	   </div>
	   <!-- /Main Wrapper -->
	  
		<!-- jQuery -->
		<script src="/static/js/jquery-3.7.1.min.js"></script>
		
		<!-- Bootstrap Core JS -->
		<script src="/static/js/bootstrap.bundle.min.js"></script>

		<!-- Owl Carousel -->
		<script src="/static/js/owl.carousel.min.js"></script>	
		
		<!-- Custom JS -->
		<script src="/static/js/script.js"></script>
		

	</body>
	<script>
        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }

        const csrftoken = getCookie('csrftoken');

		password = document.getElementById("password")
		password2= document.getElementById("password2")


	message_box = document.getElementById("message_box")
	message_content = document.getElementById("message-content")
	message_type = document.getElementById("message-type")
	message_icon_parent = document.getElementById("message-icon-parent")
	message_icon_child = document.getElementById("message-icon-child")

	card = document.getElementById("card")


    const url = window.location.href;
    const parts = url.split('/');
    const verify_token = parts[parts.length - 2];
            




	document.getElementById('reset_password_form').addEventListener('submit', async function (e) {
		e.preventDefault();
		card.style.display = "none"


		let data = {
			password: password.value,
			password2: password2.value

		};

		await fetch(`${window.location.origin}/api/reset-password/${verify_token}/`, {


			method: "POST",
			headers: {
				"Content-Type": "application/json",
                "X-CSRFToken": csrftoken
			},
			body: JSON.stringify(data)
		}).then(response => response.json())
			.then(response => {

				console.log(response);
				if (response.success) {
					card.style.display = "flex"
					card.style.borderLeft = "10px solid green"

					message_content.innerHTML = response.message
					message_type.innerHTML = "Success"
					message_type.style.color = "green"
					message_icon_parent.style.color = "green"
					message_icon_child.classList = "fas fa-check-circle"

					valueReset();
					scrollToTop();
					setTimeout(()=>{
						window.location.href="/signin/"
					},2000)
					
					// Handle success case
				} else {
					console.log(response.message)

					message_content.innerHTML = response.message
					// Update message type and icon

					card.style.display = "flex "
					card.style.borderLeft = "10px solid red"

					message_type.innerHTML = "Error";
					message_type.style.color = "red";
					message_icon_parent.style.color = "red";
					message_icon_child.classList = "fas fa-times-circle";
					scrollToTop();
					// Handle error case
				}
			}).catch(error => {
				console.error('Error:', error);
			});
	});


	document.getElementById("message_close").onclick = () => {
		card.style.display = "none"
	}




	function valueReset() {
		password.value = ""
		password2.value = ""

	}


	function scrollToTop() {
		window.scrollTo(0, 0);
	}
	</script>
</html>